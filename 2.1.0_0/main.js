!function(){"use strict";function g(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function x(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}var E,D,p,N,S;console.log("BluePrism plugin loaded"),E="00000000-0000-0000-0000-000000000000",D={},p=new CryptographyProvider(new HashAlgorithm(CryptoJS.SHA256),new SymmetricAlgorithm(CryptoJS.AES),CryptoJS.lib.WordArray.random),N=x(),S=chrome.runtime.connect({name:N}),function(){var t,r={GetAddress:function(e){f(e,document.location.href)},SetAddress:function(e){document.location.href=e.Data},GetCursorPosition:function(e){f(e,o)},ClickElement:function(e){c(e.Data,function(e){if(e.fireEvent)e.fireEvent("onclick");else{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}})},FocusElement:function(e){c(e.Data,function(e){return e.focus()})},GetElementBounds:function(e){var t=u(e.Data,function(e){var t=e.getBoundingClientRect();return{x:Math.floor(t.x),y:Math.floor(t.y),width:Math.floor(t.width),height:Math.floor(t.height)}});null===t&&(t={x:-1,y:-1,width:0,height:0});f(e,t)},GetElementId:function(e){var t=u(e.Data,function(e){return e.id});f(e,t)},GetElementName:function(e){var t=u(e.Data,function(e){return e.name});f(e,t)},GetElementType:function(e){var t=u(e.Data,function(e){return e.tagName});f(e,t)},GetElementClass:function(e){var t=u(e.Data,function(e){return e.className.toString()});f(e,t)},GetElementPath:function(e){var t=u(e.Data,y);f(e,t)},GetElementValue:function(e){var t=u(e.Data,function(e){return e.value});f(e,t)},GetElementText:function(e){var t=u(e.Data,function(e){return"INPUT"===e.tagName?e.value:e.innerText});f(e,t)},GetElementByPath:function(e){var t=function(e){return document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}(e.Data);f(e,null===t?E:h(t))},GetElementsByType:function(e){var t=[].slice.call(document.getElementsByTagName(e.Data)).map(h);f(e,t)},GetElementsByClass:function(e){var t=[].slice.call(document.getElementsByClassName(e.Data)).map(h);f(e,t)},GetElementsByName:function(e){var t=[].slice.call(document.getElementsByName(e.Data)).map(h);f(e,t)},GetElementById:function(e){var t=document.getElementById(e.Data);f(e,null===t?E:h(t))},GetDescendants:function(e){var t=u(e.Data,function(e){return[].slice.call(e.querySelectorAll("*")).map(h)});null===t&&(t=[]);f(e,t)},GetElementIsChecked:function(e){var t=u(e.Data,function(e){return e.checked});f(e,t||!1)},SetElementValue:function(t){c(t.Data.ElementId,function(e){void 0!==e.value&&(e.value=t.Data.Value)})},SetCheckedState:function(t){c(t.Data.ElementId,function(e){e.checked=t.Data.Value})},HighlightElement:function(e){var t=D[e.Data.ElementId];if(null==t)return void s();i.style.display="block";var n=t.getBoundingClientRect();i.style.left=n.x+"px",i.style.top=n.y+window.pageYOffset+"px",i.style.width=n.width+"px",i.style.height=n.height+"px",i.style.border="2px solid "+e.Data.Color,i.style.pointerEvents="None"},RemoveHighlighting:function(){s()},GetRootElement:function(e){var t=document.documentElement;f(e,h(t))},GetElementClientBounds:function(e){var t=u(e.Data,function(e){return{x:Math.floor(e.clientLeft||0),y:Math.floor(e.clientTop||0),width:Math.floor(e.clientWidth||0),height:Math.floor(e.clientHeight||0)}});null===t&&(t={x:-1,y:-1,width:0,height:0});f(e,t)},GetElementOffsetBounds:function(e){var t=u(e.Data,function(e){return{x:Math.floor(e.offsetLeft||0),y:Math.floor(e.offsetTop||0),width:Math.floor(e.offsetWidth||0),height:Math.floor(e.offsetHeight||0)}});null===t&&(t={x:-1,y:-1,width:0,height:0});f(e,t)},GetElementScrollBounds:function(e){var t=u(e.Data,function(e){return{x:Math.floor(e.scrollLeft||0),y:Math.floor(e.scrollTop||0),width:Math.floor(e.scrollWidth||0),height:Math.floor(e.scrollHeight||0)}});null===t&&(t={x:-1,y:-1,width:0,height:0});f(e,t)},GetElementChildCount:function(e){var t=u(e.Data,function(e){return e.childElementCount});f(e,t)},GetElementIsEditable:function(e){var t=u(e.Data,function(e){return e.isContentEditable});f(e,t)},GetElementStyle:function(e){var t=u(e.Data,function(e){return JSON.stringify(e.style)});f(e,t)},GetElementTabIndex:function(e){var t=u(e.Data,function(e){return e.tabIndex});f(e,t)},GetElementAttribute:function(t){var e=u(t.Data.ElementId,function(e){return e.getAttribute(t.Data.AttributeName)});f(t,e)},SelectElement:function(e){c(e.Data,function(e){if("OPTION"===e.tagName)e.selected="selected";else{var t=document.createRange();t.setStartBefore(e),t.setEndAfter(e);var n=window.getSelection();n.removeAllRanges(),n.addRange(t)}})},SetElementAttribute:function(t){c(t.Data.ElementId,function(e){return e.setAttribute(t.Data.AttributeName,t.Data.Value)})},ScrollToElement:function(e){c(e.Data,function(e){return e.scrollIntoView(!0)})},SubmitElement:function(e){c(e.Data,function(e){"form"===e.tagName.toLowerCase()&&void 0!==e.submit&&e.submit()})},GetLinkAddressText:function(e){var t=u(e.Data,function(e){return e.href});f(e,t)},GetElementIsVisible:function(e){var t=u(e.Data,function(e){return"none"!==window.getComputedStyle(e).display});f(e,t)},UpdateCookie:function(e){document.cookie=e.Data},GetElementIsOnScreen:function(e){var t=u(e.Data,function(e){var t=e.getBoundingClientRect(),n=Math.max(document.documentElement.clientHeight,window.innerHeight);return!(t.bottom<0||0<=t.top-n)});f(e,t)},GetListItems:function(e){var t=u(e.Data,function(e){return[].concat(g(e.querySelectorAll("option,li"))).map(function(e){return{Text:e.innerText,Value:e.value||null,IsSelected:!!e.selected}})});f(e,t)},SelectListItem:function(u){c(u.Data.ElementId,function(e){var t=[].concat(g(e.querySelectorAll("option"))),n=!0,r=!1,a=void 0;try{for(var o,i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){o.value.selected=""}}catch(e){r=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw a}}if(0<u.Data.Index)t[u.Data.Index-1].selected="selected";else{var l=t.filter(function(e){return e.innerText===u.Data.Name});l[0]&&(l[0].selected="selected")}})},AddToListSelection:function(l){c(l.Data.ElementId,function(e){var t=[].concat(g(e.querySelectorAll("option")));if(0<l.Data.Index)t[l.Data.Index-1].selected="selected";else{var n=!0,r=!1,a=void 0;try{for(var o,i=t.filter(function(e){return e.innerText===l.Data.Name})[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){o.value.selected="selected"}}catch(e){r=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw a}}}})},RemoveFromListSelection:function(l){c(l.Data.ElementId,function(e){var t=[].concat(g(e.querySelectorAll("option")));if(0<l.Data.Index)t[l.Data.Index-1].selected="";else{var n=!0,r=!1,a=void 0;try{for(var o,i=t.filter(function(e){return e.innerText===l.Data.Name})[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){o.value.selected=""}}catch(e){r=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw a}}}})},InjectJavascript:function(e){var t=document.createElement("script"),n=document.createTextNode(e.Data);t.appendChild(n),document.getElementsByTagName("BODY")[0].appendChild(t)},InvokeJavascript:function(e){var t=document.createElement("script"),n=document.createTextNode(e.Data.FunctionName+".apply(this,"+e.Data.Parameters+");");t.appendChild(n),document.getElementsByTagName("BODY")[0].appendChild(t)},GetElementLabel:function(e){var t=u(e.Data,function(e){if(e.id){var t=document.querySelectorAll('label[for="'+e.id+'"]');if(1===t.length)return t[0].innerText}for(;e.parentElement;)if("LABEL"===(e=e.parentElement).tagName)return e.innerText;return""});f(e,t)},SetElementTextRange:function(e){var t=e.Data.ElementId,a=e.Data.StartIndex,o=e.Data.Length;c(t,function(e){if(-1!==["INPUT","TEXTAREA"].indexOf(e.nodeName))return e.focus(),void e.setSelectionRange(a-1,a-1+o);var t=function e(t){if(3===t.nodeType)return t;var n=!0,r=!1,a=void 0;try{for(var o,i=t.childNodes[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var l=e(o.value);if(l)return l}}catch(e){r=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw a}}return null}(e);if(t){var n=document.createRange();n.setStart(t,a-1),n.setEnd(t,a-1+o);var r=window.getSelection();r.removeAllRanges(),r.addRange(n)}})},GetElementSelectedText:function(e){var t=u(e.Data,function(e){return new n(e,window.getSelection()).getSelectedText()});f(e,t)},GetTableColumnCount:function(e){var t=u(e.Data,function(e){return e.rows[0].cells.length});f(e,t)},GetTableRowCount:function(e){var t=u(e.Data,function(e){return e.rows.length});f(e,t)},GetTableCellText:function(e){var t=e.Data.RowNumber,n=e.Data.ColumnNumber,r=u(e.Data.ElementId,function(e){return e.rows[t].cells[n].innerText});f(e,r)},GetElementAccessKey:function(e){var t=u(e.Data,function(e){return e.accessKey});f(e,t)},GetIsListItemSelected:function(e){var t=u(e.Data,function(e){return e.selected});f(e,t)},GetSliderRange:function(e){var t=u(e.Data,function(e){return{Minimum:e.min,Maximum:e.max}});f(e,t)},DoubleClickElement:function(e){c(e.Data,function(e){if(e.fireEvent)e.fireEvent("ondblclick");else{var t=document.createEvent("MouseEvents");t.initMouseEvent("dblclick",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}})}},a=void 0,o=void 0,i=void 0,l=void 0;t=setInterval(function(){S.postMessage({name:"makeConnection",pageId:N})},1e3),S.onMessage.addListener(function(e){"acknowledged"===e.message?(l=N,function(){if(m)return;window.onmouseout=function(e){o=a=void 0,d(v("MouseHover",E))},window.onmousemove=function(e){var t=void 0===e.x?e.clientX:e.x,n=void 0===e.y?e.clientY:e.y;a=document.elementsFromPoint(t,n).filter(function(e){return e!==i})[0],o={x:t,y:n},d(v("MouseHover",h(a)))},(i=document.createElement("div")).style="position: absolute; display: none",window.setInterval(function(){i.style.zIndex=16777271}),document.getElementsByTagName("body")[0].appendChild(i),m=!0}(),clearInterval(t)):function(e){var t=p.decrypt(e.message,l),n=JSON.parse(t);r[n.MessageType](n)}(e)});var n=function(a,f){function d(e){return(e.innerText||e.wholeText).replace(/[\t\r]/g," ").replace(/[\n]/g,"").trim()}function l(e,t){if(e.isEqualNode(t))return!0;var n=!0,r=!1,a=void 0;try{for(var o,i=e.childNodes[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){if(l(o.value,t))return!0}}catch(e){r=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw a}}return!1}function u(e){if(f.containsNode(e))return e;var t=!0,n=!1,r=void 0;try{for(var a,o=e.childNodes[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var i=u(a.value);if(i)return i}}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return null}function e(){if("None"===f.type||!v)return"";if(c&&m)return f.toString();if(!c&&!m)return d(a);var e=function e(t){var n="";if(t.nodeType===s&&f.containsNode(t)){var r=d(t);n=""<r?r+" ":""}var a=!0,o=!1,i=void 0;try{for(var l,u=t.childNodes[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c=e(l.value);n=void 0!==n?n.concat(c):""}}catch(e){o=!0,i=e}finally{try{!a&&u.return&&u.return()}finally{if(o)throw i}}return n}(a).trim(),t=c?o:i;if(!t.nodeType===s)return e;var n=c?f.anchorOffset:f.focusOffset,r=d(t);return u(a).isEqualNode(t)?e.substring(n,e.length):e.substring(0,e.length-r.length+n)}var s=3,n=["INPUT","TEXTAREA"],o=f.anchorNode,i=f.focusNode,c=l(a,o),m=l(a,i),v=null!==u(a);this.getSelectedText=function(){return-1!==n.indexOf(a.nodeName)?function(){var e=a.parentNode;if(e&&f.containsNode(e))return a.value||a.defaultValue;if(!i)return"";var t=null!==i.firstChild?n.indexOf(i.children[0].nodeName):-1;return o.isEqualNode(i)&&-1!==t?f.toString():""}():e().replace(/[\t\n\r]/g," ")}};function c(e,t){var n=D[e];null!=n&&t(n)}function u(e,t){var n=D[e],r=null;return null!=n&&(r=t(n)),r}function f(e,t){d(v(e.messageType,t,e.ConversationId))}function d(e){S.postMessage({name:"sendMessage",pageId:N,message:e})}function s(){i.style="position: absolute; display: none"}var m=!1;function v(e,t,n){var r=2<arguments.length&&void 0!==n?n:x();return p.encrypt(function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:x();return JSON.stringify({ConversationId:n,MessageType:e,Data:t,pageId:N})}(e,t,r),l)}function h(t){var e=Object.keys(D).map(function(e){return{element:D[e],key:e}}).filter(function(e){return e.element===t});if(0<e.length)return e[0].key;var n=x();return D[n]=t,n}function y(e){if("HTML"===e.tagName)return"/HTML[1]";if(e===document.body)return"/HTML[1]/BODY[1]";for(var t=0,n=e.parentNode.childNodes,r=0;r<n.length;r++){var a=n[r];if(a===e)return y(e.parentNode)+"/"+e.tagName+"["+(t+1)+"]";1===a.nodeType&&a.tagName===e.tagName&&t++}return""}}()}();